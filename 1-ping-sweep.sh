#!/bin/bash

GLOBAL='./GLOBAL_CONST.sh' 
TMP_FILE="tmp.out"

source $GLOBAL

### CREATE DIR IF NOT EXISTS ####
isDirExists $QUICK_SCAN_DIR

echo "********************************************"
echo "This script will do a arp-scan -l command "
echo " and the result will be saved into $LIVE_HOSTS file."
echo "********************************************"

#### START PING SWEEP
##echo -n "Nmapping subnet $IP_CDIR"
##nmap -sP $IP_CDIR --exclude $MY_IP -oG $TMP_FILE;cat $TMP_FILE|cut -d " " -f 2|sort -u > $LIVE_HOSTS;sed -i -e 's/Nmap//g' $LIVE_HOSTS;cat $LIVE_HOSTS;rm $TMP_FILE
echo "Arp scanning..."
arp-scan -I $IF -l -N -r 1 --ignoredups --localnet | grep -E '([a-f0-9]{2}:){5}[a-f0-9]{2}' | awk '{print $1}' > $LIVE_HOSTS && cat $LIVE_HOSTS


echo "If $OUTPUT_FILE looks good, please trim out-of-scope hosts"
