#!/bin/bash

GLOBAL="./GLOBAL_CONST.sh"
source $GLOBAL


HTTP_NMAP_SCRIPTS="http-enum,http-headers,http-methods,http-iis-webdav-vuln,http-php-version,http-put,http-wordpress-enum,http-wordpress-users"

echo "***********************************************************"
echo "This script will start HTTP recon by scanning hosts in $HTTP_SWEEP_FILE."
echo "Please make sure you include all IP addresses to do recon in the above file."
echo "Upon confirmation, the script will run nmap with --script=$HTTP_NMAP_SCRIPTS"
echo "All output will be saved to it's respective IP folder in $HOSTS_NMAP_DIR."
echo "***********************************************************"

for ip in $(cat $HTTP_SWEEP_FILE)
do
	OUTDIR=$HOSTS_NMAP_DIR/$ip
	isDirExists $OUTDIR
	nmap -sS --script=$HTTP_NMAP_SCRIPTS -p $HTTP $ip > $OUTDIR/$ip-http-nmap-script.txt
done
