#!/bin/bash


RPTFILE="/tmp/privesc-enum.rpt"

echo "*****************************************************************"
echo "This script is reconning the local system once lower shell obtained."
echo "******************************************************************"
read

UUID=$(echo $EUID)
if [ $UUID -eq 0 ] 
then
    echo "You are in ROOT mode, exiting.."
    exit
else 
    echo "Unfortunately, you are not ROOT, keep escalatin..." > $RPTFILE
    echo "" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Enumeration commencing now!" > $RPTFILE
    echo "" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "Target Distro" >> $RPTFILE
    cat /etc/*release >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "/etc/passwd File" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    cat /etc/passwd >> $RPTFILE
    echo "" >> $RPTFILE
    echo "User Groups" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    grpinfo=`for i in $(cat /etc/passwd 2>/dev/null| cut -d":" -f1 2>/dev/null);do id $i;done 2>/dev/null`
    if [ "$grpinfo" ]; then
	echo $grpinfo >> $RPTFILE
	echo -e "\n" >> $RPTFILE
    else 
       :
    fi
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Home Directories" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    ls -lR /home >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Kernel Information" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    uname -a >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "/etc/profile File" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    cat /etc/profile >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Environment Variables" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    env  >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Is there a printer?" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    lpstat -a >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Current Processes by ROOT" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    ps aux |grep root >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Software Packages Installed?" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    dpkg -l >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "List of .conf Files" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    ls /etc/*.conf >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Any misconfigured CONF Files?" >> $RPTFILE 
    echo "*****************************************************************" >> $RPTFILE
    ls -aRl /etc/ | awk '$1 ~ /^.*r.*/' >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "Network Information" >> $RPTFILE
    /sbin/ifconfig -a
    cat /etc/network/interfaces
    cat /etc/sysconfig/network    
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
#    echo "Firewall Rules" >> $RPTFILE
#    echo "*****************************************************************" >> $RPTFILE
#    iptables -L >> $RPTFILE
#    echo "*****************************************************************" >> $RPTFILE
#    echo "" >> $RPTFILE
    echo "Netstat Information" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    netstat -antup >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "Cron Jobs /etc" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    ls -l /etc/cron* >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE
    echo "" >> $RPTFILE
    echo "ENUMERATION COMPLETED!!!!!" >> $RPTFILE
    echo "*****************************************************************" >> $RPTFILE

fi
