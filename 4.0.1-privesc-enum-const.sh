#!/bin/bash

BASE_DIR="/tmp/PE"

if [ ! -d "$BASE_DIR" ]; then
    mkdir -p $BASE_DIR
fi

OS_ENUM=("Distro.rpt" "cat /etc/issue" "cat /etc/*release" "cat /etc/lsb-release" "cat /etc/redhat-release")
KERNEL_ENUM=("Kernel.rpt" "cat /proc/version" "uname -a" "uname -mrs")
ENV_ENUM=("Environment.rpt" "cat /etc/profile" "cat /etc/bashrc" "cat ~/.bash_profile" "cat ~/.bashrc" "cat ~/.bash_logout" "env")
USER_ENUM=("Users.rpt" "cat /etc/passwd" "cat /etc/group" "cat /etc/shadow")
SVCS_ENUM=("Services.rpt" "ps aux" "ps -ef" "cat /etc/services")
PKG_ENUM=("Packages.rpt" "dpkg -l")
CONF_ENUM=("Configuration.rpt" "ls -alR /etc/*.conf")
CRON_ENUM=("CronJobs.rpt" "ls -laR /etc/cron*")
WWW_ENUM=("WebPasswd.rpt" "grep -R \"passw\" /var/www/*")
NET_ENUM=("Networking.rpt" "netstat -antup" "netstat -antpx" "lsof -i")
LOGON_ENUM=("Logons.rpt" "last" "lastlog")
ROUTE_ENUM=("Routing.rpt" "arp -e" "route")
HOME_ENUM=("Homes.rpt" "ls -ahlR /home" "ls -ahlR /root")
BASH_ENUM=("BashHistory.rpt" "cat ~/.bash_history")
SUID_ENUM=("SUID.rpt" "find / -perm -u=s -type f -exec ls -ld {} \; 2>/dev/null")
GUID_ENUM=("GUID.rpt" "find / -perm -g=s -type f 2>/dev/null")
FOLDER_ENUM=("Folders.rpt" "find / -writable -type d -exec ls -ld {} \; 2>/dev/null")
FILE_ENUM=("Files.rpt" "find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print -exec ls -ld {} \;")
APPS_ENUM=("Programs.rpt" "which gcc" "which python" "which nc" "which nmap" "which netcat" "which wget" "which perl")

MASTER=("${OS_ENUM[@]}" "${KERNEL_ENUM[@]}" "${ENV_ENUM[@]}" "${USER_ENUM[@]}" 
	"${SVCS_ENUM[@]}" "${PKG_ENUM[@]}" "${CONF_ENUM[@]}" "${CRON_ENUM[@]}" "${WWW_ENUM[@]}" 
	"${NET_ENUM[@]}" "${LOGON_ENUM[@]}" "${ROUTE_ENUM[@]}" "${HOME_ENUM[@]}" "${BASH_ENUM[@]}" 
	"${SUID_ENUM[@]}" "${GUID_ENUM[@]}" "${FOLDER_ENUM[@]}" "${FILE_ENUM[@]}" "${APPS_ENUM[@]}")



