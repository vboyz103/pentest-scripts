#!/bin/bash

ID="$(echo $EUID)"

if [ $ID -ne 0 ]
then
    echo "Usage: sudo $0"
    exit
fi


GLOBAL="./GLOBAL_CONST.sh"
source $GLOBAL

echo "**********************************************"
echo "IMPORTANT: Before running please make sure that"
echo "you set proper attributes in the GLOBAL_CONST.sh, "
echo "hit any key when read..."
echo "***********************************************"
read

FLAG=0

echo "Running ping sweep..."
./1-ping-sweep.sh
echo "*********************************************************"
echo "Please look at $LIVE_HOSTS file and adjust IP if needed."
echo "Hit any key to continue..."
echo "*********************************************************"
read

echo "Running tcp/udp scan..."
./2-hosts-nmap.sh

echo "Running FTP/HTTP/SNMP/SMB specific scan..."
for sc in $(ls 1.1.*)
do
    ./$sc
done

isFileExists $FTP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running run ftp scan..."
	./3-recon-ftp-hosts.sh
fi

isFileExists $HTTP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running nmap with HTTP scripts..."
	./3-recon-http-hosts.sh
	echo "Running dirb..."
	./3-recon-http-dirb.sh
	echo "Running nikto..."
	./3-recon-http-nikto.sh
fi

isFileExists $SMB_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running SAMBA scan..."
	./3-recon-smb-enum.sh
fi

isFileExists $SNMP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running SNMP scan..."
	./3-recon-snmp-check.sh
fi

