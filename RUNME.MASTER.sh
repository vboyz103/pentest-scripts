#!/bin/bash

ID="$(echo $EUID)"

if [ $ID -ne 0 ]
then
    echo "Usage: sudo -E $0"
    exit
fi


GLOBAL="./GLOBAL_CONST.sh"
source $GLOBAL

echo "**********************************************"
echo "IMPORTANT: Before running please make sure that"
echo "you set proper attributes in the GLOBAL_CONST.sh, "
echo "hit any key when read..."
echo "***********************************************"
read

isFileExists $LIVE_HOSTS
FLAG=$?

if [ $FLAG -eq 0 ]; then
  echo "Running ping sweep..."
  ./1-ping-sweep.sh
  echo "*********************************************************"
  echo "Please look at $LIVE_HOSTS file and adjust IP if needed."
  echo "Hit any key to continue..."
  echo "*********************************************************"
  read
else
  echo "Existing host [$LIVE_HOSTS] file exist with IP:"
  cat $LIVE_HOSTS
  echo "Continue? "
  read
fi

echo "Running FTP/HTTP/SNMP/SMB/SMTP specific scan..."
for sc in $(ls 1.1.*)
do
    ./$sc
done


echo "Running tcp/udp scan..."
./2-hosts-nmap.sh

isFileExists $HTTP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running nmap with HTTP scripts..."
	./3-recon-http-hosts.sh
	echo "Running dirb..."
	./3-recon-http-dirb.sh
	echo "Running nikto..."
	./3-recon-http-nikto.sh
fi

isFileExists $FTP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running run ftp scan..."
	./3-recon-ftp-hosts.sh
fi

isFileExists $SMTP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running run smtp scan..."
	./3-recon-smtp-hosts.sh
fi

isFileExists $SMB_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running SAMBA scan..."
	./3-recon-smb-enum.sh
fi

isFileExists $SNMP_SWEEP_FILE
FLAG=$?
if [ $FLAG -eq 1 ] 
then
	echo "Running SNMP scan..."
	./3-recon-snmp-check.sh
fi

